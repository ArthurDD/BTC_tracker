{% extends 'base.html' %}

{% block main_content %}
    {% load static %}
    <script src="{% static 'user_interface/javascript/user_interface.js' %}"></script>
    <div class="row" style="height:100%; width: 100%">
        <div class='col-6' >
            <div class="container" style="border-right: solid 2px; border-right-color: #fa9d4b; margin-left: 12px">
                <div class="col-9" style="padding-left: 12px; padding-right: 12px">
                    <h4> Track an address: </h4>
                    <form id="starting_form" class="form-group" action="{% url 'display_graph' %}">
                        {% csrf_token %}
                        <div class="form-group mb-2">
                            <label for="address_input">Input Address:</label><br>
                            <input type="text" id="address_input" class="form-control" name="address_input"><br>
                        </div>
                        <div class="form-group mb-2">
                            <label for="layer_input">Number of layer(s):</label><br>
                            <select id="layer_input" class="form-select" name="layer_input" style="max-width: 80px">
                                {% for i in max_layer_number %}
                                    <option value="{{ i }}">{{ i }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <button id="submit_starting_btn" class="btn mb-2 my-4 btn_submit" type="submit" style="margin-top: 0rem">
                            Start tracking!
                        </button>
                    </form>
                </div>

                <script>
                    $(document).ready(function () {
                        $("#starting_form").submit(function (e) {
                            e.preventDefault(); // prevent actual form submit
                            {#console.log("WE HERE")#}
                            let form = $(this);

                            // Send the ws to start the parsing
                            let values = {};
                            $.each(form.serializeArray(), function(i, field) {
                                values[field.name] = field.value;
                            });
                            $('#terminal_output').val('');
                            socket.send(JSON.stringify({
                                'message': 'It should work :(',
                                'type': 'start_parsing',
                                'data': values,
                            }));
                        });
                    });
                </script>
                <div id="terminal_output_div" class="jumbotron .jumbotron-fluid">
                    <div class="container">
{#                        <button id="submit_button" class="btn"> Dummy Button</button>#}

                        <label for="terminal_output"> <h4> Output Console:</h4>
                        </label>
                        <textarea id="terminal_output" class="container" readonly></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class='col-6' style="height: 100%">
            <div id="graph_div" class="container">
                <h4> Bitcoin Graph: </h4>
                <div id="graph">

                </div>

            </div>

        </div>
    </div>



{% endblock main_content %}